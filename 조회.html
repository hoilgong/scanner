<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>상품 존 조회</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
<style>
  body { font-family: Arial; padding: 20px; }
  #scanner { width: 100%; max-width: 400px; margin-bottom: 10px; }
  #zone { font-weight: bold; margin-top: 20px; font-size: 18px; }
</style>
</head>
<body>
<h2>상품 존 조회</h2>
<div id="scanner"></div>
<div id="zone">스캔 후 존이 표시됩니다</div>

<script>
let skuMap = {};

// 최신 데이터 fetch
fetch("https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec")
  .then(res => res.json())
  .then(data => skuMap = data);

// QuaggaJS 초기화
Quagga.init({
  inputStream: { 
    type : "LiveStream",
    target: document.querySelector('#scanner'),
    constraints: { facingMode: "environment" }
  },
  decoder: { readers: ["code_128_reader","ean_reader","ean_8_reader"] }
}, function(err) {
  if(err){ console.error(err); return; }
  Quagga.start();
});

// 바코드 인식
Quagga.onDetected(function(result){
  let code = result.codeResult.code;
  let zone = skuMap[code] || "미등록 코드";
  document.getElementById("zone").innerText = "존: " + zone;
});
</script>
</body>
</html>
