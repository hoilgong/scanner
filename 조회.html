<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>상품 존 조회</title>

<!-- QuaggaJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>

<style>
  body{ font-family:Arial;padding:20px; }
  #scanner{
    width:100%;
    max-width:600px;
    margin:auto;
    border:2px solid #888;
  }
  #zone{
    margin-top:20px;
    font-size:22px;
    font-weight:bold;
  }
</style>
</head>
<body>

<h2>상품 존 조회</h2>
<div id="scanner"></div>
<div id="zone">스캔 후 존이 표시됩니다</div>

<script>

let skuMap = {};

// 실제 Google Apps Script URL 넣기!!!
fetch("https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec")
.then(r=>r.json())
.then(d=>skuMap = d);


// ===========================
// 바코드 스캔
// ===========================
Quagga.init({
  inputStream:{
    type:"LiveStream",
    target:document.querySelector('#scanner'),
    constraints:{
      facingMode:"environment"
    }
  },
  decoder:{
    readers:[
      "code_128_reader",
      "ean_reader",
      "ean_8_reader",
      "code_39_reader",
      "upc_reader",
      "upc_e_reader"
    ]
  },
  locate:true,
  patchSize:"x-large"
}, err=>{
  if(err){console.log(err);return;}
  Quagga.start();
});


// ===========================
// 감지 이벤트
// ===========================
Quagga.onDetected(res=>{
  let code = res.codeResult.code;
  let zone = skuMap[code] || "미등록 코드";
  document.getElementById("zone").innerText = `바코드: ${code} / 존: ${zone}`;

  // 진동 (모바일)
  if(navigator.vibrate){
    navigator.vibrate(200);
  }
});

</script>
</body>
</html>
